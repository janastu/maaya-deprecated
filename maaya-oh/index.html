<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
	    <title>Oral history</title>
	    <meta name="description" content="" />
	    <meta name="author" content="" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link type="text/css" rel="stylesheet" href="css/bootstrap.css" />
		<link type="text/css" rel="stylesheet" href="css/theme/main.css" />

		  <!-- audio player css-->
		  <link href="js/jplayer/skin/pink.flag/css/jplayer.pink.flag.css" rel="stylesheet">

		  <!-- image slider -->
		    <link href="js/lightGallery-master/dist/css/lightgallery.min.css" rel="stylesheet">
		<link href="js/lightGallery-master/dist/css/lg-transitions.min.css" rel="stylesheet">
		<link rel="js/jquery-ui-1.12.1.custom/jquery-ui.css" type="text/css" href="">
		<script type='text/javascript' src='js/underscore-min.js'></script>
		<script type='text/javascript' src='transcript.js'></script>
		<script type='text/javascript' src='resources.js'></script>
		<script type="application/ld+json" id="page-schema">
		
		
		
		
		{ 
		 "@context": "http://schema.org", 
		 "@type": "Article",
		 "headline": "Chandan Mitra Interview",
		 "alternativeHeadline": "Chandan Mitra Interview with Farah Yameen",
		 "image": "http://example.com/image.jpg",
		 "author": "Farah Yameen", 
		 "editor": "", 
		 "genre": "culture", 
		 "keywords": "Emergency, Indira Gandhi, 1975", 
		 "wordcount": "",
		 "url": "http://www.example.com",
		 "datePublished": "2015-09-20",
		 "dateCreated": "2015-09-20",
		 "dateModified": "2015-09-20",
		 "description": "Chandan Mitra Recalls 1975 Emergency, the events that lead to the dark times",
		 "articleBody": "You can paste your entire post in here, and yes it can get really really long.",
		 "hasPart": [],
		 "inLanguage": "English,Kannada",
		 "license": "",
		 "mentions": ["Emergency", " 1975", " Indira Gandhi", " George Fernandez", " JP Movement", " RSS"],
		 "coverage": ["India", " Delhi", " North Campus", " 1975 Emergency"],
		 "thumbnailUrl": "",
		 "publisher": {
		 	"@context": "https://schema.org",
		 	"@type": "Organization",
		 	"name": "Gottingen University",
		 	"logo": "logo.jpg"
		 	},
		 	"mainEntity": "Chandan Mitra",
		 "audio": {
			"@context": "https://schema.org",
			"@type": "AudioObject",
			"transcript": "transcript.js",
			"bitrate": "",
			"contentSize": "",
			"contentUrl": "https://longemergency.demx.in/assets/audio-new/Chandan%20Mitra%20interview%20with%20Farah%20Yameen.mp3",
			"duration": "3730",
			"embedUrl": "url",
			"endTime": "1:02:10",
			"playerType": "",
			"productionCompany": "Gottingen University",
			"uploadDate": "",
			"about": "",
			"accountablePerson": "Farah Yameen",
			"alternativeHeadline": "",
			"audience": "",
			"author": "",
			"citation": "",
			"contentLocation": "India",
			"contributor": "Farah Yameen",
			"editor": "",
			"creator": "",
			"funder": "",
			"inLanguage": "English",
			"license": "",
			"text": "",
			"thumbnailUrl": "",
			"translator": "n/a"
		}
		}
		</script>

		<!-- script to expose the JSON to app -->
		<script type="text/javascript">
			OH = window.OH || {};
			OH.jsonld = JSON.parse(document.getElementById('page-schema').innerHTML);
		</script>
</head>
<body>
	

<!-- curatorial Note -->
<div class="container">
    <div class="row">
    	<h2 id="page-heading">
    	<script type="text/javascript">
		document.write(OH.jsonld.headline);
		</script>
    	<small id="page-subheading"> with 
    	    	<script type="text/javascript">
    			document.write(OH.jsonld.author);
    			</script>
    		</small>
    	</h2>
  

		<div class='col-md-3'  >
			<div class="column-wrap">
			  			
				    <!-- Audio player temmplate and COntainer -->
				  <div id="player-wrap" class="ui-widget-content">
				  	<!-- Audio player container -->
				  	<div id="jquery_jplayer_1" class="jp-jplayer"></div>
				    <div id="jp_container_1" class="jp-audio" role="application" aria-label="media player">
				      <div class="jp-type-single">
				        <div class="jp-gui jp-interface">
				          <div class="jp-volume-controls">
				            <button class="jp-mute" role="button" tabindex="0">mute</button>
				            <button class="jp-volume-max" role="button" tabindex="0">max volume</button>
				            <div class="jp-volume-bar">
				              <div class="jp-volume-bar-value"></div>
				            </div>
				          </div>
				          <div class="jp-controls-holder">
				            <div class="jp-controls">
				              <button class="jp-play" role="button" tabindex="0">play</button>
				              <button class="jp-stop" role="button" tabindex="0">stop</button>
				            </div>
				            <div class="jp-progress">
				              <div class="jp-seek-bar">
				                <div class="jp-play-bar"></div>
				              </div>
				            </div>
				            <div class="jp-current-time" role="timer" aria-label="time">&nbsp;</div>
				            <div class="jp-duration" role="timer" aria-label="duration">&nbsp;</div>
				            <div class="jp-toggles">
				              <button class="jp-repeat" role="button" tabindex="0">repeat</button>
				            </div>
				          </div>
				        </div>
				        <div class="jp-details">
				          <div class="jp-title" aria-label="title">&nbsp;</div>
				        </div>
				        <div class="jp-no-solution">
				          <span>Update Required</span>
				          To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.
				        </div>
				      </div>
				    </div>
				<!-- End audio player -->

				
			</div>
			<!-- End player wrap -->

			  <div id = 'copyright' class="column-wrap">
				<p><b>Description: </b> 
			    	<script type="text/javascript">
					document.write(OH.jsonld.description);
					</script>
				</p>
				<p><b>Interviewee: </b> 
				    	<script type="text/javascript">
						document.write(OH.jsonld.author);
						</script>
						 </p>
				<!--p><b>Contributor: </b> 
				    	<script type="text/javascript">
						document.write(OH.jsonld.audio.contributor);
						</script>
					</p-->
								
				<p>
				<b>Session Focus: </b> 1975 - The Long Emergency
				</p>
				<p>
				<b>Mentions: </b>
				    	<script type="text/javascript">
						document.write(OH.jsonld.mentions);
						</script>
				</p>
				<p>
				<b>Coverage: </b>
				    	<script type="text/javascript">
						document.write(OH.jsonld.coverage);
						</script>
			</p>


				<p style='font-size: 12px;font-family:google open sans font'>
			    	<script type="text/javascript">
					document.write(OH.jsonld.license);
					</script> 
				</p>

				
			</div>
		
			</div>
		</div>

		
		<div class='col-md-5'>
			<div class='border-wrap-short'>
				<h4><small> Subtitles </small> </h4>
				<div id="subtitles">
				</div>
			</div>
		</div>
		<div class = 'col-md-4' style=''>
			<div class='border-wrap-short'>
				<h4><small> Curator's note </small> </h4>
				<div id='annotations'></div>
			</div>
		</div>
		<div class = 'col-md-9' style=''>
			<div class='border-wrap'>
				<div id='media-resource'>
					<!--img src="http://gk.chaluvaraju.pantoto.org/static/uploads/mangalya_daarana2.JPG">

					<img src="http://gk.chaluvaraju.pantoto.org/static/uploads/DSC01812.JPG">

					<img src="http://gk.chaluvaraju.pantoto.org/static/uploads/DSC02396.JPG">

					<img src="http://gka-photoshoot.pantoto.org/17April/thumbnail/500X500/IMG_9146.jpg">

					<img src="http://gka-photoshoot.pantoto.org/17April/thumbnail/500X500/IMG_0165.jpg">

					<img src="http://gk.chaluvaraju.pantoto.org/static/uploads/Teppotsava_Pond_located_left_side_of_the_Virupaksha_Temple_gk.jpg">

					<img src="http://gka-photoshoot.pantoto.org/17April/IMG_9292.jpg"-->

					
				</div>
				
			</div>
		</div>


		</div>
	</div>



	
</div>	



		
	


<!--<div class="col-sm-12">
	<div class="text-center" style="margin-top:15px; font-family: roboto;">
		<a data-toggle="modal" data-target="#ncbs-content-policy" style="cursor: pointer;     color: #333726;">copyright &copy 2016</a>
	</div>
</div>-->
</div>


   


<script type='text/javascript' src='js/jquery.min.js'></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<!-- audio player and slide show -->
  <script type="text/javascript" src="js/lightGallery-master/dist/js/lightgallery-all.js"></script>
<script type="text/javascript" src="js/jplayer/jplayer/jquery.jplayer.min.js"></script>

<script type="text/javascript" src="js/jplayer/jplayer/jquery.jplayer.min.js"></script>

<!--script type="text/javascript" src="libs/jplayer/jplayer/jquery.jplayer.swf"></script-->

<script src="js/jplayer/add-on/jplayer.playlist.min.js"></script>
<script src="js/jquery-ui-1.12.1.custom/jquery-ui.js"></script>

<script>
//get time data
$('.timer').click(function(e) {
 currentTime(this.innerHTML);
});

	// change audio time 
  function currentTime(time){	
  	
  	//convert mm:ss to seconds
  	var seconds = time.split(':');
  	seconds = seconds[0]*60 + seconds[1]*1; 
  	
  	//change audio time
  	var speech =document.getElementById('audio');
  	speech.currentTime = seconds;
  	speech.play();	
  	};
  
</script>

<script type="text/javascript">
  $(document).ready(function(){
  	window.OH = window.OH || {};
  	OH.data = transcript || [];
  	OH.utilities = {};
  	OH.$audioPlayer = $("#jquery_jplayer_1");
  	OH.subtitlesElement = document.getElementById("subtitles");
  	OH.resourcesCollection = document.getElementById("media-resource");
  	OH.annotations = document.getElementById("annotations");
  	console.log("ready");
  	OH.init = function() {

  		// normalize data for app needs
  		// add property end
  		OH.data.map(function(item, index, arr){ 
  			i = index+1; 
  			if(i<arr.length) {
  				item.end = arr[i].start;
  			} else item.end = OH.jsonld.audio.endTime  
  			return item;
  		});

  		//compile subtitle data with html and create DOm
  		OH.createSubtitle();
  		OH.createResources();
  		OH.createNotes();
  		// Initialize Jplayer and bind audio events
  		OH.initPlayer();
  	}


  	//Readabale time format -> not using this yet
  	 OH.utilities.fancyTimeFormat = function (time)
  	 {   
  	     // Hours, minutes and seconds
  	     var hrs = ~~(time / 3600);
  	     var mins = ~~((time % 3600) / 60);
  	     var secs = time % 60;

  	     // Output like "1:01" or "4:03:59" or "123:03:59"
  	     var ret = "";

  	     if (hrs > 0) {
  	     	//console.log("hour", hrs);
  	         ret += "" + hrs + ":" + (mins < 10 ? "0" : "");
  	     }

  	     ret += "" + mins + ":" + (secs < 10 ? "0" : "");
  	     ret += "" + secs;
  	     console.log("min", mins, secs);
  	     //return {min: mins, sec: secs};
  	     return ret;
  	 }

  	 //HH:MM:SS to seconds, because transcript units needs conversion
  	 OH.utilities.hmsToSecondsOnly = function(str) {
  	     var p = str.split(':'),
  	         s = 0, m = 1;

  	     while (p.length > 0) {
  	         s += m * parseInt(p.pop(), 10);
  	         m *= 60;
  	     }

  	     return s;
  	 }

  	 // subtile Dom update data
  	 
  	 OH.createSubtitle = function()
	     {
	         var element;
	         //console.log(transcript, "transcript in subtitle");
	         for (var i = 0; i < OH.data.length; i++) {
	             element = document.createElement('p');
	             element.setAttribute("id", "c_" + i);
	             element.setAttribute("class", "playing");
	             element.innerText = OH.data[i].start + " - " + OH.data[i].text + " ";
	             element.style.display = 'none';
	             OH.subtitlesElement.appendChild(element);
	         }
	     }

	OH.createResources = function() {
		var element;
		var el_img;

		for (var i = 0; i < resources.length; i++) {
			for(var j=0; j < resources[i].resources.length; j++){
				if(resources[i].resources[j].type === "image"){
					element = document.createElement('a');
					element.setAttribute("href", resources[i].resources[j].url);
					element.setAttribute("class", "playing");
					element.setAttribute("id", "r_" + i);
					element.setAttribute("target", "_blank");
					el_img = document.createElement('img');
					//el_img.setAttribute("id", "r_" + i);
					//el_img.setAttribute("class", "playing");
					el_img.setAttribute("src", resources[i].resources[j].url);
					element.appendChild(el_img);
				}
				else if(resources[i].resources[j].type === "embed"){
					element = document.createElement('div');
					element.setAttribute("id", "r_" + i + j);
					element.setAttribute("class", "playing");
					element.innerHTML = resources[i].resources[j].html;
					console.log(element);
				}
				element.style.display = 'none';
				OH.resourcesCollection.appendChild(element);
			}
			
			
		}
	}
	OH.createNotes = function(){
		var element;
		for (var i = 0; i < OH.data.length; i++) {
		    element = document.createElement('p');
		    element.setAttribute("id", "n_" + i);
		    element.setAttribute("class", "playing");
		    element.innerText = OH.data[i].tag;
		    element.style.display = 'none';
		    OH.annotations.appendChild(element);
		}
	}
  	OH.initPlayer = function(){
  		OH.$audioPlayer.jPlayer({
  		  ready: function () {
  		    $(this).jPlayer("setMedia", {
  		      title: OH.jsonld.headline,
  		      mp3: OH.jsonld.audio.contentUrl,
  		      artist: OH.jsonld.author
  		    });

		      $(this).bind($.jPlayer.event.timeupdate, function(event) {
	      	

	      	 	OH.data.forEach(function(element, index, array){
	      	 		//console.log("expected transcrript item", element, index, array);
	      	 
				// hide stale data
				if($(OH.subtitlesElement).find('.playing:visible').length > 1){
				
					$(OH.subtitlesElement.children[index]).siblings().css('display', 'none');
					//$(OH.subtitlesElement).filter(':visible').toggle('display');
				}
				//hide stale annotations
				if($(OH.annotations).find('.playing:visible').length > 1){
				
					$(OH.annotations.children[index]).siblings().css('display', 'none');
				}
				// show relevant data
               if( event.jPlayer.status.currentTime >= OH.utilities.hmsToSecondsOnly(element.start) && event.jPlayer.status.currentTime <= OH.utilities.hmsToSecondsOnly(element.end) ) {
               			  //console.log("if trye", OH.subtitlesElement.children[index], index);
               		    OH.subtitlesElement.children[index].style.display ='block'; 
               		    OH.annotations.children[index].style.display = 'block';    
               }  
                                   	 
	      	 });

      	 resources.forEach(function(element, index, array){
      	 	//hide stale data
      	 	if($(OH.resourcesCollection).find($('[id^=r_]:visible')).length >1){
      	 		$('[id^=r_'+index+']').css('display', 'none');
      	 	}

      	 	//show relevant data
      	 	if( event.jPlayer.status.currentTime >= OH.utilities.hmsToSecondsOnly(element.start) && event.jPlayer.status.currentTime <= OH.utilities.hmsToSecondsOnly(element.end) ) {
      	 		console.log("if trye", $('[id^=r_'+index+']'), index);
      	 		$('[id^=r_'+index+']').css('display', 'block');
      	 			    //OH.resourcesCollection.children[index].style.display ='block';                		    
      	 	}  

      	 })

		   });
  		 },
  		  cssSelectorAncestor: "#jp_container_1",
  		  swfPath: "/js/jplayer/jplayer",
  		  supplied: "mp3",
  		  useStateClassSkin: true,
  		  autoBlur: false,
  		  smoothPlayBar: true,
  		  keyEnabled: true,
  		  remainingDuration: true,
  		  toggleDuration: true
  		});


  	}
    
  	OH.init();
  });
</script>

<!-- UI code -->
<!--script type="text/javascript">
	$('#player-wrap, .border-wrap')
	.draggable({
		addClasses: true,
		classes: {
		  "ui-draggable": "highlight"
		},
		cursor: "crosshair"
	});

	$('.border-wrap').resizable({
		addClasses: true,
		classes: {
		  "ui-draggable": "highlight"
		},
		cursor: "crosshair"
	});
</script-->

</body>

</html>
